SELECT 
      DISTINCT PRODUCT_TYPE,
      COUNT(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCT,
      COUNT(DISTINCT TRANSACTION_ID) AS NUMBER_OF_SALES,
      TRANSACTION_QTY,UNIT_PRICE,PRODUCT_CATEGORY,STORE_LOCATION,
      
      SUM(TRANSACTION_QTY*UNIT_PRICE) AS TOTAL_REVENUE,
      SUM(TRANSACTION_ID) AS NUMBER_OF_CUSTOMERS,
      SUM(TRANSACTION_QTY) AS NUMBER_ITEMS_SOLD,

      --Purchase date and time
      TO_DATE(TRANSACTION_DATE) AS PURCHASE_DATE,
      TO_CHAR(TRANSACTION_DATE, 'YYYYMM') AS MONTH_ID,
      MONTHNAME(TRANSACTION_DATE) AS MONTH_NAME,
      DAYOFWEEK(TRANSACTION_DATE) AS DAY_OF_WEEK,
      DAYOFMONTH(TRANSACTION_DATE) AS DAY_OF_MONTH,
      DAYNAME(TRANSACTION_DATE) AS DAY_NAME,
      HOUR (TRANSACTION_TIME) AS HOUR_OF_DAY,
      
    --TIMES OF THE DAY  
 CASE
      WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '10:59:59' THEN 'MORNING'
      WHEN TRANSACTION_TIME BETWEEN '11:00:00' AND '15:00:00' THEN 'MIDDAY'
      WHEN TRANSACTION_TIME BETWEEN '15:01:00' AND '18:00:00' THEN 'AFTERNOON' 
      ELSE 'EVENING'
      END AS TRADING_TIME
FROM
  "BRIGHTCOFFEESHOP"."PUBLIC"."COFFEE_SHOP"
GROUP BY ALL
ORDER BY TOTAL_REVENUE DESC;
